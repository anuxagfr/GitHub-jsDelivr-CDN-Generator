<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Tool - CDN Generator</title>
    
    <!-- Firebase SDK Scripts -->
    <script src="https://www.gstatic.com/firebasejs/9.15.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.15.0/firebase-auth-compat.js"></script>

    <style>
        /* --- THEME VARIABLES --- */
        :root {
            --primary-color: #0d6efd; --primary-hover: #0b5ed7;
            --text-dark: #212529; --text-light: #6c757d;
            --bg-light: #f8f9fa; --bg-white: #ffffff;
            --border-color: #dee2e6; --danger-color: #dc3545;
            --danger-hover: #c82333; --google-blue: #4285F4;
            --github-dark: #333; --shadow-color: rgba(0,0,0,0.05);
            --theme-transition: background-color 0.3s ease, color 0.3s ease;
        }

        /* --- DARK MODE THEME --- */
        body.dark-mode {
            --primary-color: #4dabf7; --primary-hover: #74c0fc;
            --text-dark: #e9ecef; --text-light: #adb5bd;
            --bg-light: #121212; --bg-white: #1e1e1e;
            --border-color: #495057; --danger-color: #e03131;
            --danger-hover: #f03e3e; --shadow-color: rgba(255,255,255,0.05);
        }

        /* --- GENERAL & LAYOUT STYLES --- */
        html { scroll-behavior: smooth; }
        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif;
            background-color: var(--bg-light); color: var(--text-dark);
            margin: 0; padding: 60px 0 0; line-height: 1.6;
            transition: var(--theme-transition);
        }
        .container { max-width: 960px; margin: 0 auto; padding: 20px; }
        .section { padding: 40px 20px; }
        .section h2 { text-align: center; margin-bottom: 30px; font-size: 2em; }
        .hidden { display: none; }

        /* --- NAVIGATION BAR --- */
        nav {
            background-color: var(--bg-white); padding: 0 20px;
            box-shadow: 0 2px 5px var(--shadow-color); position: fixed;
            top: 0; width: 100%; height: 60px; z-index: 1000;
            display: flex; justify-content: center; align-items: center;
            box-sizing: border-box; border-bottom: 1px solid var(--border-color);
            transition: var(--theme-transition), border-bottom 0.3s ease;
        }
        .nav-container { display: flex; align-items: center; width: 100%; max-width: 960px; }
        .logo { font-size: 1.5em; font-weight: bold; color: var(--primary-color); text-decoration: none; }
        .nav-links { list-style: none; margin: 0; padding: 0; display: flex; align-items: center; gap: 20px; margin-left: 30px; }
        .nav-links a { color: var(--text-dark); text-decoration: none; font-weight: 500; transition: color 0.3s ease; cursor: pointer; }
        .nav-links a:hover { color: var(--primary-color); }
        .nav-actions { display: flex; align-items: center; gap: 15px; margin-left: auto; }
        .hamburger { display: none; cursor: pointer; background: none; border: none; padding: 0; z-index: 1001;}
        .hamburger .bar { display: block; width: 25px; height: 3px; margin: 5px auto; background-color: var(--text-dark); transition: all 0.3s ease-in-out; }

        /* --- CARDS & FORMS --- */
        .card {
            background-color: var(--bg-white); padding: 25px; margin-bottom: 20px;
            border-radius: 8px; box-shadow: 0 2px 5px var(--shadow-color);
            border: 1px solid var(--border-color);
            transition: var(--theme-transition), border 0.3s ease;
        }
        .form-group { margin-bottom: 15px; }
        .form-group label { display: block; margin-bottom: 5px; font-weight: 500; }
        .form-group input {
            width: 100%; padding: 10px;
            background-color: var(--bg-light); border: 1px solid var(--border-color);
            border-radius: 4px; color: var(--text-dark);
            box-sizing: border-box; transition: var(--theme-transition);
        }
        #token-details { cursor: pointer; color: var(--primary-color); font-size: 0.9em; }

        /* --- BUTTONS & USER PROFILE --- */
        .cta-button { display: inline-block; background-color: var(--primary-color); color: var(--bg-white) !important; padding: 12px 25px; border-radius: 5px; text-decoration: none; font-weight: bold; margin-top: 20px; border: none; cursor: pointer; transition: background-color 0.3s ease; }
        .cta-button:hover { background-color: var(--primary-hover); }
        .nav-actions button { border: none; padding: 8px 16px; border-radius: 5px; font-size: 0.9em; font-weight: 500; cursor: pointer; transition: background-color 0.3s ease; }
        #user-info { display: none; align-items: center; gap: 10px; }
        #user-name { font-weight: 500; }
        #logout-button { background-color: var(--danger-color); color: white; }
        #logout-button:hover { background-color: var(--danger-hover); }
        .profile-picture {
            width: 36px;
            height: 36px;
            border-radius: 50%;
            object-fit: cover;
            border: 2px solid var(--border-color);
        }

        /* --- File List & Output --- */
        #file-browser { margin-top: 20px; }
        #search { width: 100%; margin-bottom: 15px; }
        #fileList { list-style: none; padding: 0; margin: 0; max-height: 400px; overflow-y: auto; border: 1px solid var(--border-color); border-radius: 4px; }
        #fileList li { padding: 10px 15px; display: flex; justify-content: space-between; align-items: center; border-bottom: 1px solid var(--border-color); }
        #fileList li:last-child { border-bottom: none; }
        #fileList li button { font-size: 0.8em; padding: 4px 8px; }
        .output-container { margin-top: 20px; }
        .input-group { display: flex; margin-bottom: 10px; }
        .input-group input { flex-grow: 1; border-right: none; border-top-right-radius: 0; border-bottom-right-radius: 0; }
        .input-group .link-icon { padding: 8px 12px; border: 1px solid var(--border-color); background-color: var(--bg-light); cursor: pointer; border-top-right-radius: 4px; border-bottom-right-radius: 4px; }
        .input-group .link-icon:hover { background-color: var(--border-color); }
        .download-btn { display: inline-block; margin-top: 10px; }
        #status-message { margin-top: 15px; font-weight: 500; }
        #customAlert { position: fixed; bottom: 20px; left: 50%; transform: translateX(-50%); background-color: var(--primary-color); color: white; padding: 15px 25px; border-radius: 5px; z-index: 2000; opacity: 0; visibility: hidden; transition: opacity 0.3s, visibility 0.3s; }
        #customAlert.show { opacity: 1; visibility: visible; }
        
        /* --- RESPONSIVE STYLES --- */
        @media (max-width: 768px) {
            .nav-links {
                display: none; flex-direction: column; width: 100%;
                background-color: var(--bg-white); position: absolute;
                top: 60px; left: 0; padding: 20px 0;
                box-shadow: 0 2px 5px var(--shadow-color);
                border-top: 1px solid var(--border-color);
            }
            .nav-links.active { display: flex; }
            .nav-links li { margin: 10px 0; text-align: center; }
            .hamburger { display: block; }
            .hamburger.active .bar:nth-child(2) { opacity: 0; }
            .hamburger.active .bar:nth-child(1) { transform: translateY(8px) rotate(45deg); }
            .hamburger.active .bar:nth-child(3) { transform: translateY(-8px) rotate(-45deg); }
        }
    </style>
</head>
<body>

    <script>
        (function() {
            if (window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches) {
                document.body.classList.add('dark-mode');
            }
        })();
    </script>

    <nav>
        <div class="nav-container">
            <a href="index.html" class="logo">CDN Generator</a>
            <ul class="nav-links">
                <li><a href="index.html">Home</a></li>
                <li><a href="tool.html" style="color: var(--primary-color);">Tool</a></li>
            </ul>
            <div class="nav-actions">
                <div id="user-info">
                    <img id="profile-picture" src="https://placehold.co/36x36/eee/ccc?text=?" alt="Profile Picture" class="profile-picture">
                    <span id="user-name"></span>
                    <button id="logout-button">Logout</button>
                </div>
            </div>
            <button class="hamburger">
                <span class="bar"></span>
                <span class="bar"></span>
                <span class="bar"></span>
            </button>
        </div>
    </nav>

    <div class="container">
        <!-- Main Tool Content -->
        <div id="demo" class="section card">
            <h2>CDN Generator Tool</h2>
            <div class="form-group">
                <label for="user">GitHub Username</label>
                <input type="text" id="user" placeholder="e.g., anuxagfr" value="anuxagfr">
            </div>
            <div class="form-group">
                <label for="repo">Repository Name</label>
                <input type="text" id="repo" placeholder="e.g., GitHub-jsDelivr-CDN-Generator" value="GitHub-jsDelivr-CDN-Generator">
            </div>
            <div class="form-group">
                <label for="branch">Branch</label>
                <input type="text" id="branch" placeholder="e.g., main" value="main">
            </div>
            <details>
                <summary id="token-details">Advanced: Add Token for Private Repos</summary>
                <div class="form-group" style="margin-top: 15px;">
                    <label for="token">GitHub Personal Access Token (Optional)</label>
                    <input type="password" id="token" placeholder="Enter token here">
                </div>
            </details>
            
            <button class="cta-button" onclick="fetchFiles()">Browse Files</button>
            <p id="status-message"></p>

            <div id="file-browser" class="hidden">
                <div class="form-group">
                    <input type="text" id="search" onkeyup="filterFiles()" placeholder="Search for a file...">
                </div>
                <ul id="fileList"></ul>
            </div>
        </div>

        <div id="output-container" class="card hidden">
            <h2>Generated Links</h2>
            <div id="output"></div>
        </div>
    </div>
    
    <div id="customAlert">Copied to clipboard!</div>

    <script>
        // --- START: FIREBASE CONFIGURATION ---
                 const firebaseConfig = {
    apiKey: "AIzaSyC_U_pYSYWNm6Q1ufFwQE_tYlQZIYeDU0g",
    authDomain: "cdn-generator.firebaseapp.com",
    projectId: "cdn-generator",
    storageBucket: "cdn-generator.firebasestorage.app",
    messagingSenderId: "44677120607",
    appId: "1:44677120607:web:b4719f7b7c6414cd19d1ea",
    measurementId: "G-9RK16SGB09"
  };

        // --- END: FIREBASE CONFIGURATION ---

        // --- INITIALIZATION ---
        firebase.initializeApp(firebaseConfig);
        const auth = firebase.auth();

        // --- DOM ELEMENT REFERENCES ---
        const userInfo = document.getElementById('user-info');
        const userNameSpan = document.getElementById('user-name');
        const profilePicture = document.getElementById('profile-picture');
        const logoutButton = document.getElementById('logout-button');
        const hamburger = document.querySelector('.hamburger');
        const navLinks = document.querySelector('.nav-links');
        
        // --- AUTHENTICATION ---
        auth.onAuthStateChanged(user => {
            if (user) {
                const displayName = user.displayName || user.email;
                userNameSpan.textContent = displayName;
                
                if (user.photoURL) {
                    profilePicture.src = user.photoURL;
                } else {
                    // Create a default profile picture with user's initial if none exists
                    const initial = (displayName ? displayName.charAt(0) : '?').toUpperCase();
                    profilePicture.src = `https://placehold.co/36x36/0d6efd/ffffff?text=${initial}`;
                }

                userInfo.style.display = 'flex';
            } else {
                window.location.href = 'tool.html';
            }
        });
        logoutButton.addEventListener('click', () => auth.signOut());

        // --- AUTOMATIC DARK MODE ---
        const darkModeMediaQuery = window.matchMedia('(prefers-color-scheme: dark)');
        function updateTheme(event) {
            document.body.classList.toggle('dark-mode', event.matches);
        }
        darkModeMediaQuery.addEventListener('change', updateTheme);
        updateTheme(darkModeMediaQuery);

        // --- HAMBURGER MENU ---
        hamburger.addEventListener('click', () => {
            hamburger.classList.toggle('active');
            navLinks.classList.toggle('active');
        });

        // --- CDN GENERATOR LOGIC ---
        let fileCache = [];
        const statusMessage = document.getElementById("status-message");
        const fileBrowser = document.getElementById("file-browser");
        const outputContainer = document.getElementById("output-container");

        function fetchFiles() {
            const user = document.getElementById("user").value.trim();
            const repo = document.getElementById("repo").value.trim();
            const branch = document.getElementById("branch").value.trim() || "main";
            const token = document.getElementById("token").value.trim();

            if (!user || !repo) {
                statusMessage.textContent = "Username and Repository are required.";
                return;
            }

            statusMessage.textContent = "Fetching repository data...";
            fileBrowser.classList.add("hidden");
            outputContainer.classList.add("hidden");

            fetch(`https://api.github.com/repos/${user}/${repo}/git/trees/${branch}?recursive=1`, {
                headers: token ? { Authorization: `token ${token}` } : {}
            })
            .then(res => res.json())
            .then(data => {
                if (!data.tree || data.message) {
                    throw new Error(data.message || "Invalid repository, branch, or token.");
                }
                fileCache = data.tree.filter(f => f.type === "blob");
                renderFileList(fileCache, user, repo, branch);
                statusMessage.textContent = `Found ${fileCache.length} files.`;
                fileBrowser.classList.remove("hidden");
                document.getElementById("search").value = "";
            })
            .catch(err => {
                statusMessage.textContent = `Error: ${err.message}`;
            });
        }

        function renderFileList(files, user, repo, branch) {
            const list = document.getElementById("fileList");
            list.innerHTML = "";
            files.forEach(f => {
                const cdn = `https://cdn.jsdelivr.net/gh/${user}/${repo}@${branch}/${f.path}`;
                const li = document.createElement("li");
                li.innerHTML = `
                    <span>${f.path}</span>
                    <button class="cta-button" onclick="showCDN('${cdn}', '${f.path}')">Get Link</button>
                `;
                list.appendChild(li);
            });
        }

        function showCDN(cdnLink, path) {
            outputContainer.classList.remove("hidden");
            const output = document.getElementById("output");
            output.innerHTML = "<p>Loading file details...</p>";

            const ext = path.split('.').pop().toLowerCase();
            const fileName = path.split('/').pop();
            let tag = "";

            if (ext === "js") tag = `<script src="${cdnLink}"><\/script>`;
            else if (ext === "css") tag = `<link rel="stylesheet" href="${cdnLink}">`;
            else if (["png", "jpg", "jpeg", "gif", "webp", "svg"].includes(ext)) tag = `<img src="${cdnLink}" alt="${fileName}">`;

            fetch(cdnLink, { method: 'HEAD' })
                .then(res => {
                    const size = res.headers.get("content-length");
                    const sizeKB = size ? (parseInt(size) / 1024).toFixed(2) : "Unknown";
                    const type = res.headers.get("content-type") || "Unknown";

                    output.innerHTML = `
                        <p><strong>File Name:</strong> ${fileName}</p>
                        <p><strong>Type:</strong> ${type}</p>
                        <p><strong>Size:</strong> ${sizeKB} KB</p>

                        <p><strong>CDN Link:</strong></p>
                        <div class="input-group">
                            <input id="cdnInput" value="${cdnLink}" readonly>
                            <div class="link-icon" onclick="copyToClipboard('${cdnLink}')" title="Copy">
                                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" viewBox="0 0 16 16"><path d="M4 1.5H3a2 2 0 0 0-2 2V14a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2V3.5a2 2 0 0 0-2-2h-1v1h1a1 1 0 0 1 1 1V14a1 1 0 0 1-1 1H3a1 1 0 0 1-1-1V3.5a1 1 0 0 1 1-1h1v-1z"/><path d="M9.5 1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5v-1a.5.5 0 0 1 .5-.5h3zM-1 3.5A1.5 1.5 0 0 1 .5 2H2a1.5 1.5 0 0 1 1.5 1.5v1A1.5 1.5 0 0 1 2 6H.5A1.5 1.5 0 0 1-1 4.5v-1z"/></svg>
                            </div>
                        </div>

                        ${tag ? `
                        <p><strong>HTML Tag:</strong></p>
                        <div class="input-group">
                            <input id="tagInput" value='${tag}' readonly>
                            <div class="link-icon" onclick="copyToClipboard('${tag}')" title="Copy">
                                 <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" viewBox="0 0 16 16"><path d="M4 1.5H3a2 2 0 0 0-2 2V14a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2V3.5a2 2 0 0 0-2-2h-1v1h1a1 1 0 0 1 1 1V14a1 1 0 0 1-1 1H3a1 1 0 0 1-1-1V3.5a1 1 0 0 1 1-1h1v-1z"/><path d="M9.5 1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5v-1a.5.5 0 0 1 .5-.5h3zM-1 3.5A1.5 1.5 0 0 1 .5 2H2a1.5 1.5 0 0 1 1.5 1.5v1A1.5 1.5 0 0 1 2 6H.5A1.5 1.5 0 0 1-1 4.5v-1z"/></svg>
                            </div>
                        </div>` : ''}

                        <a class="cta-button download-btn" href="${cdnLink}" download="${fileName}">Download File</a>
                    `;
                    outputContainer.scrollIntoView({ behavior: 'smooth' });
                })
                .catch(() => {
                    output.innerHTML = `
                        <p>Error loading file details. You can still download the file.</p>
                        <a class="cta-button download-btn" href="${cdnLink}" download="${fileName}">Download file</a>
                    `;
                });
        }

        function copyToClipboard(text) {
            const textArea = document.createElement("textarea");
            textArea.value = text;
            document.body.appendChild(textArea);
            textArea.select();
            try {
                document.execCommand('copy');
                showCopyAlert();
            } catch (err) {
                statusMessage.textContent = 'Copy failed. Please copy manually.';
            }
            document.body.removeChild(textArea);
        }
        
        function showCopyAlert() {
            const alert = document.getElementById("customAlert");
            alert.classList.add("show");
            setTimeout(() => {
                alert.classList.remove("show");
            }, 2000);
        }

        function filterFiles() {
            const keyword = document.getElementById("search").value.toLowerCase();
            const filtered = fileCache.filter(f => f.path.toLowerCase().includes(keyword));
            const user = document.getElementById("user").value;
            const repo = document.getElementById("repo").value;
            const branch = document.getElementById("branch").value || "main";
            renderFileList(filtered, user, repo, branch);
        }
    </script>
</body>
</html>



